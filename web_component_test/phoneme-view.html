<template id="phoneme">
    <style>
        .phoneme_grid {
            display: grid;
            grid-column-gap: 0px;
            grid-row-gap: 0px;
            background-color: #E0E0E0;
            /* rgb(86, 183, 89);*/
            height: 120px;
            width: 120px;
            grid-auto-columns: 40px;
            grid-auto-rows: 40px;
        }

        .phoneme_grid:hover {
            background-color: #BABABA;
        }

        .phoneme_grid > div {
            /*border : 1px solid white;*/
        }

        .phoneme_sound {
            grid-row: 1;
            grid-column: 3;
            justify-self: center;
            align-self: center;
        }

        .phoneme_symbol {
            grid-row: 2;
            grid-column: 2;
            justify-self: center;
            align-self: center;

            font-family: Lato, Arial;
            font-size: 3em;
        }

        .phoneme_example {
            grid-row: 3;
            grid-column: 2;
            justify-self: center;
            align-self: center;

            font-weight: 200;
            font-family: DejaVuSansLight;
            opacity: 0.7;
        }

        .phoneme_example > strong
        {
            font-family: DejaVuSans;
        }

        .speaker {
            width: 16px;
            height: 16px;
        }
    </style>

    <div class="phoneme_grid">
        <div class="phoneme_sound">
            <img class="speaker" src="speaker.svg">
        </div>
        <div class="phoneme_symbol">{0}</div>
        <div class="phoneme_example">{1}</div>
    </div>

</template>
<script>
   'use strict';

    var currentDoc = document.currentScript.ownerDocument;
    
    class PhonemeView extends HTMLElement {
        constructor() {
            super();

            var root = this.attachShadow({mode: 'closed'}); // .createShadowRoot() est déprécié

            var template = currentDoc.querySelector('#phoneme');
            var clone = document.importNode(template.content, true);
            
            // TODO attributes handling
            var symbol = this.getAttribute("symbol");
            if(symbol != null && this.symbol != symbol)
            {
                this.symbol = symbol;
            }
            clone.querySelector('.phoneme_symbol').innerText = this.symbol;

            var exampleAttr = this.getAttribute("example");
            if(exampleAttr != null && this.exampleAttr != exampleAttr)
            {
                this.exampleAttr = exampleAttr;
            }
            this.exampleAttr = this.exampleAttr.replace('{', '<strong>');
            this.exampleAttr = this.exampleAttr.replace('}', '</strong>');
            clone.querySelector('.phoneme_example').innerHTML = this.exampleAttr;

            var soundAttr = this.getAttribute("sound");
            console.log(soundAttr);
            
            clone.querySelector('.speaker').onmouseover = 
                function() 
                {
                    console.log(soundAttr);
                    var audio = new Audio(soundAttr);
                    audio.crossOrigin = 'anonymous';
                    audio.play();
                };

            root.appendChild(clone);
        }
    }
    
    customElements.define('phoneme-view', PhonemeView); // document.registerElement est dépréciée
</script>